<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="shortcut icon" href="/images/blog/favicon.svg"><meta name="keywords" content=""><meta name="description" content=""><link rel="stylesheet" href="/styles/main.css"><link rel="stylesheet" href="/styles/post.css"><title>JAVA 8 DURATION 详解 - Daydream</title><meta name="generator" content="Hexo 7.3.0"></head><body><header><nav><ul><li><a href="/">Home</a></li><li><a href="/posts/"><span>Posts</span></a></li><li><a href="/categories/"><span>Categories</span></a></li><li><a href="/about"><span>About</span></a></li></ul></nav></header><main><header><h1>JAVA 8 DURATION 详解</h1><div><time>2018-05-08</time><div class="post-categories"><span class="category-tree"><span class="category-separator">/</span> <a href="/categories/dev/">dev</a></span></div><div class="post-tags"><span class="tag"><span class="category-separator">#</span> <a href="/tags/java/">java</a></span></div></div></header><p>最近发现spring boot中的有些配置使用了Duration，于是详细的看了Duration这个类</p><p>Duration是在Java8中加入的，主要是用来计算日期，差值之类的。<br>Duration被声明final（immutable），并且线程安全。</p><p>先看下Duration的实例化方式，由于构造器被私有了，对外只提供了一个ZERO实例，主要是使用静态工厂方法来进行实例化</p><ul><li>自定义初始化方式，这种方式主要是以一系列of…()方法为主，可以自定义时分秒。<br>of(long amount, TemporalUnit unit) 在ZERO的基础上加上一定时间,第一个参数指定数量,第二个指定单位,单位可使用ChronoUnit(实现了TemporalUnit)<br>from(TemporalAmount amount) 通过TemporalAmount获取一个Duration实例,也是在ZERO的基础上增加</li><li>转换字符串方式，类似于SimpleDateFormat的格式化日期方式<br>Duration字符串类似数字有正负之分,默认正,负以’-‘开头,紧接着’P’,下面所有字母都不区分大小写:<br>‘D’ – 天<br>‘H’ – 小时<br>‘M’ – 分钟<br>‘S’ – 秒<br>字符’T’是紧跟在时分秒之前的，每个单位都必须由数字开始,且时分秒顺序不能乱,比如:P2DT3M5S,P3D,PT3S<br>PT3M2S 等于 -PT-3M-2S</li><li>通过日期获取，这种方式实现是 between(Temporal startInclusive, Temporal endExclusive) 方法，该方法获取两个时间段的Duration实例,Temporal有多种实现,其中就有jdk1.8中添加的LocalTime等等<br>下面介绍基本的公共方法，主要是对Duration做一些基本操作：</li></ul><p>时间转换为时分秒:toSeconds(),to…()等方法<br>两个Duration比较:compareTo()相等返回0,大于返回正数,小于返回负数<br>获取指定单位的数值:get(TemporalUnit unit)<br>获取Duration中所有单位:getUnits()<br>获取Duration绝对值:abs()<br>给指定Temporal添加一个Duration:addTo(Temporal temporal)</p><p>getNano() 获取纳秒数,获取的是纳秒部分的值,而不是转换成纳秒<br>getSeconds() 获取秒数,获取的是秒部分的值,而不是转换成秒</p><p>plusSeconds(), plus…() 加法 增加时间(时分秒),返回新实例<br>dividedBy(long divisor) 除法,返回一个新的Duration实例,内部转换成秒来实现<br>multipliedBy(long multiplicand) 惩罚,返回一个新的Duration实例,内部同样也是转换成秒来实现<br>minus…()相关方法 减法:注意是用你输入参数去减,返回的是新的Duration实例<br>四则运算都是返回的新实例，并没有对旧实例进行修改，这是需要注意的，所以千万别忽略了返回值。</p><p>返回一个负的Duration实例:negated() 比如 PT1.4S 返回 PT-1.4S<br>isZero() 判断是否是 ZERO 实例</p><p>withSeconds() 和 withNanos() 两个方法通过传入秒数或者纳秒数来构造一个Duration副本</p><p>最后来看下Duration实现原理，其实很简单，Duration内部维护了 seconds 和 nanos 两个内部 long 型变量用来记录实际的Duration值，上面的所有操作其实基本都是对这两个内部变量的操作。<br>构造Duration实例中核心方法是:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Duration <span class="hljs-title function_">create</span><span class="hljs-params">(<span class="hljs-type">long</span> seconds, <span class="hljs-type">int</span> nanoAdjustment)</span> &#123;<br> <span class="hljs-keyword">if</span> ((seconds | nanoAdjustment) == <span class="hljs-number">0</span>) &#123;<br> <span class="hljs-keyword">return</span> ZERO;<br> &#125;<br> <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Duration</span>(seconds, nanoAdjustment);<br>&#125;<br></code></pre></td></tr></table></figure><p>从这里也可以看出对Duration的实例化，其实就是对内部两个变量的一个赋值操作。</p><p>最后总结一下Duration最实用的一个功能其实是 between 方法，因为有很多时候我们需要计算两个日期之间的天数或者小时数，用这个就可以很方便的进行操作。</p><blockquote class="copyright"><p>本站所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">BY-NC-SA 4.0</a> 许可协议。转载请注明出处！</p></blockquote></main><nav class="pagination"><span class="prev"><a href="/posts/391">记一次SPRING配置文件读取问题 </a></span><span class="next"><a href="/posts/340">EFFECTIVE JAVA 3RD EDITION — 第五章 泛型</a></span></nav><script src="/js/main.js"></script><footer><p class="socials"><a href="https://github.com/lostars" target="_blank"><svg class="fontawesome-icon"><use href="/icons/fontawesome.svg#github"></use></svg> </a><a href="https://open.spotify.com/user/boyizmen" target="_blank"><svg class="fontawesome-icon"><use href="/icons/fontawesome.svg#spotify"></use></svg> </a><a href="https://space.bilibili.com/20516992" target="_blank"><svg class="fontawesome-icon"><use href="/icons/fontawesome.svg#bilibili"></use></svg> </a><input type="hidden" id="emailUser" value="bW9tbw=="> <input type="hidden" id="emailDomain" value="bWluZWkubWU="> <a id="emailLink" href="#" target="_blank"><svg class="fontawesome-icon"><use href="/icons/fontawesome.svg#email"></use></svg></a></p><p>Build with ❤ I abandon here my love</p><p>Copyright &copy; 2025 boyizmen</p></footer></body></html>
<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="shortcut icon" href="/images/blog/favicon.svg"><meta name="keywords" content=""><meta name="description" content=""><link rel="stylesheet" href="/styles/main.css"><link rel="stylesheet" href="/styles/post.css"><title>博客迁移到Hexo - Daydream</title><meta name="generator" content="Hexo 7.3.0"></head><body><header><nav><ul><li><a href="/">Home</a></li><li><a href="/posts/"><span>Posts</span></a></li><li><a href="/categories/"><span>Categories</span></a></li><li><a href="/about"><span>About</span></a></li></ul></nav></header><main><header><h1>博客迁移到Hexo</h1><div><time>2025-02-17</time><div class="post-categories"><span class="category-tree"><span class="category-separator">/</span> <a href="/categories/mess/">mess</a></span></div><div class="post-tags"><span class="tag"><span class="category-separator">#</span> <a href="/tags/hexo/">hexo</a> </span><span class="tag"><span class="category-separator">#</span> <a href="/tags/blog/">blog</a></span></div></div></header><p>逐渐意识到自己需要的只是简单的功能，像Halo、WordPress这些重量级功能强大的工具并不是我所想要的。<br>打算从Halo换到Hexo之后白嫖GitHub Pages。</p><h2 id="环境和准备"><a href="#环境和准备" class="headerlink" title="环境和准备"></a>环境和准备</h2><p>Hexo可以理解成一个markdown静态页面生成器，集成各种插件和主题，让生成的静态页面更加好看和功能强大。<br>我这里是将markdown源文件和生成的文件分开了2个仓库，如果放一起的话会简单不少。</p><h3 id="GitHub-Pages-源仓库配置"><a href="#GitHub-Pages-源仓库配置" class="headerlink" title="GitHub Pages 源仓库配置"></a>GitHub Pages 源仓库配置</h3><p>GitHub Pages读取的默认是用户 <code>username.github.io</code> 这个仓库，先创建这个仓库，加个README文件就行，主要是默认生成main分支免去再次创建分支的麻烦。</p><p>这个仓库就是用于发布Hexo生成的静态页面的仓库，也是GitHub Pages的源仓库。然后在这个仓库 <code>Settings - Pages</code> 中配置 <code>Source</code> 来自于 <code>main</code> 分支的根文件夹。</p><p>然后本机生成ssh key密钥对，将公钥配置到 <code>Settings - Deploy keys</code> ，名称就叫 <code>HEXO_DEPLOY_KEY</code> 。</p><h3 id="Hexo源仓库配置"><a href="#Hexo源仓库配置" class="headerlink" title="Hexo源仓库配置"></a>Hexo源仓库配置</h3><p>创建一个私有仓库，用于存储Hexo配置和markdown源文件，在 <code>Settings - Secrets And variables - Actions</code> 创建一个名为 <code>HEXO_DEPLOY_KEY</code> 的 <code>Secret</code> ，内容就是上面生成的私钥。GitHub Actions就是在这个仓库运行，推送静态文件到上面的仓库。</p><h3 id="本机环境配置"><a href="#本机环境配置" class="headerlink" title="本机环境配置"></a>本机环境配置</h3><ul><li>Node.js 建议12及以上</li><li>Git</li></ul><h2 id="迁移"><a href="#迁移" class="headerlink" title="迁移"></a>迁移</h2><h3 id="从Halo导出markdown源文件"><a href="#从Halo导出markdown源文件" class="headerlink" title="从Halo导出markdown源文件"></a>从Halo导出markdown源文件</h3><p>由于新版本的Halo备份是没有markdown格式的，所以只能依靠官方插件市场的 <a target="_blank" rel="noopener" href="https://github.com/Lyn4ever29/halo-plugin-export-md">halo-plugin-export-md</a> 来导出markdown文件，同时该插件还支持填充元数据，Hexo也是依赖这些元数据来处理文章的。</p><p>注意该源码导出的markdown <code>date</code> 日期是Halo里文章的创建日期，如果需要的是文章的发布日期，就需要自己fork修改了。<br>源码在 <a target="_blank" rel="noopener" href="https://github.com/Lyn4ever29/halo-plugin-export-md/blob/main/src/main/java/cn/lyn4ever/export2md/service/impl/ExportServiceImpl.java#100">#195</a> ，注意里面很多没有空判断，导致导出的元数据中很多空值，在Hexo生成静态文件时会报错，所以这里最好还是自己fork修改一份进行导出。</p><h3 id="本地配置Hexo"><a href="#本地配置Hexo" class="headerlink" title="本地配置Hexo"></a>本地配置Hexo</h3><p>安装Hexo非常简单，按照 <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/">官方文档</a> 可以很快上手。</p><p>Hexo工作目录下 <code>_config.yml</code> 配置参考 <a target="_blank" rel="noopener" href="https://hexo.io/docs/configuration.html">官方文档</a> 即可轻松配置。</p><h4 id="source"><a href="#source" class="headerlink" title="source"></a>source</h4><p><code>source</code> 文件夹是默认的存储文章markdown源文件的地方，可以在 <code>_config.yml</code> 中自定义。</p><p>该文件夹下 <code>_posts</code> 存储的是发布的文章源文件，<code>_drafts</code> 存储的是草稿。</p><h4 id="scaffolds"><a href="#scaffolds" class="headerlink" title="scaffolds"></a>scaffolds</h4><p>工作目录下的 <code>scaffolds</code> 文件夹存储的是模板文件，默认有 <code>page.md</code> <code>post.md</code> <code>draft.md</code> ，你可以自定义模板格式，然后就可以使用 <code>hexo new page|post|draft xxx</code> 来生成对应的markdown文件了。生成的文件都在上面的源文件夹下。</p><p>注意页面的生成有点不一样，<code>hexo new page xxx</code> 在source文件夹生成了 <code>source/page/index.md</code> ，也就是说页面文件都是这样的读取方式，哪怕手动创建页面也要按照这样的格式。</p><h4 id="themes"><a href="#themes" class="headerlink" title="themes"></a>themes</h4><p>主题文件夹，一般主题都是引用的别的开源项目，这里最好使用 <code>git submodule</code> 的方式来引用。</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">git submodule <span class="hljs-keyword">add</span><span class="language-bash"> url themes/xxx</span><br></code></pre></td></tr></table></figure><p>上面<code>_config.yml</code> 配置的主题就是这个 <code>xxx</code> 文件夹名称，同时主题的配置最好使用 <code>_config.xxx.yml</code> 这种格式，放在工作根目录，防止污染主题文件夹。</p><h4 id="scripts"><a href="#scripts" class="headerlink" title="scripts"></a>scripts</h4><p>这个是脚本文件夹，Hexo从这里加载js脚本。比如主题没有提供注入功能，就可以简单的注入脚本和css。其他的可以参考 <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/api/injector">这里</a></p><p>简单的操作都可以通过这里的脚本执行。</p><p>使用 <code>hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</code> 就可以本地预览了，没问题就把上面的代码推送到创建的私有仓库中。</p><h3 id="配置GitHub-Actions"><a href="#配置GitHub-Actions" class="headerlink" title="配置GitHub Actions"></a>配置GitHub Actions</h3><h3 id="安装部署插件"><a href="#安装部署插件" class="headerlink" title="安装部署插件"></a>安装部署插件</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">npm <span class="hljs-keyword">install</span> hexo-deployer-git<br></code></pre></td></tr></table></figure><p>注意这个插件配置的时候不要使用token，很难用，项目README写的不清楚，折腾半天都没搞定。<br>url使用 <code>git@github.com:xxx/xxx.git</code> ssh验证。</p><h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><p>在Hexo工作目录创建 <code>.github/workflows/pages.yml</code> ：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">name:</span> <span class="hljs-string">Pages</span>  <br>  <br><span class="hljs-attr">on:</span>  <br>  <span class="hljs-attr">push:</span>  <br>    <span class="hljs-attr">branches:</span>  <br>      <span class="hljs-bullet">-</span> <span class="hljs-string">main</span> <span class="hljs-comment"># default branch  </span><br>  <br><span class="hljs-attr">jobs:</span>  <br>  <span class="hljs-attr">build:</span>  <br>    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>  <br>    <span class="hljs-attr">steps:</span>  <br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v4</span>  <br>        <span class="hljs-attr">with:</span>  <br>          <span class="hljs-attr">token:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.GITHUB_TOKEN</span> <span class="hljs-string">&#125;&#125;</span>  <br>          <span class="hljs-comment"># If your repository depends on submodule, please see: https://github.com/actions/checkout  </span><br>          <span class="hljs-attr">submodules:</span> <span class="hljs-literal">true</span>  <br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Use</span> <span class="hljs-string">Node.js</span> <span class="hljs-number">23</span>  <br>        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-node@v4</span>  <br>        <span class="hljs-attr">with:</span>  <br>          <span class="hljs-comment"># Examples: 20, 18.19, &gt;=16.20.2, lts/Iron, lts/Hydrogen, *, latest, current, node  </span><br>          <span class="hljs-comment"># Ref: https://github.com/actions/setup-node#supported-version-syntax          node-version: &quot;23&quot;  </span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Cache</span> <span class="hljs-string">NPM</span> <span class="hljs-string">dependencies</span>  <br>        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/cache@v4</span>  <br>        <span class="hljs-attr">with:</span>  <br>          <span class="hljs-attr">path:</span> <span class="hljs-string">node_modules</span>  <br>          <span class="hljs-attr">key:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">runner.OS</span> <span class="hljs-string">&#125;&#125;-npm-cache</span>  <br>          <span class="hljs-attr">restore-keys:</span> <span class="hljs-string">|  </span><br><span class="hljs-string">            $&#123;&#123; runner.OS &#125;&#125;-npm-cache  </span><br><span class="hljs-string"></span>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">Dependencies</span>  <br>        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">install</span>  <br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Build</span>  <br>        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">build</span>  <br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">Hexo</span> <span class="hljs-string">CLI</span>  <br>        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">install</span> <span class="hljs-string">-g</span> <span class="hljs-string">hexo-cli</span>  <br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">hexo</span>  <br>        <span class="hljs-attr">env:</span>  <br>          <span class="hljs-attr">HEXO_DEPLOY_KEY:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.HEXO_DEPLOY_KEY</span> <span class="hljs-string">&#125;&#125;</span>  <br>        <span class="hljs-attr">run:</span> <span class="hljs-string">|  </span><br><span class="hljs-string">          mkdir -p ~/.ssh  </span><br><span class="hljs-string">          echo &quot;$HEXO_DEPLOY_KEY&quot; &gt; ~/.ssh/id_rsa  </span><br><span class="hljs-string">          chmod 600 ~/.ssh/id_rsa  </span><br><span class="hljs-string">          ssh-keyscan github.com &gt;&gt; ~/.ssh/known_hosts  </span><br><span class="hljs-string">          git config --global user.name &quot;username&quot;  </span><br><span class="hljs-string">          git config --global user.email &quot;email&quot;  </span><br><span class="hljs-string">          hexo d -m &quot;$&#123;&#123; github.event.head_commit.message &#125;&#125;&quot;</span><br></code></pre></td></tr></table></figure><p>主要是最后一步的ssh配置，读取的key就是上面配置在私有仓库的key，其他的按照自己的配置即可。</p><p><code>submodules: true</code> 构建时自动拉取子模块的代码。</p><p>推送配置文件之后即可自动触发构建，GitHub Pages公开仓库也会有个默认的构建。</p><p>推送私有仓库时候如果不想触发构建，可以在提交信息添加 <code>[skip actions]</code> 来跳过，可以参考 <a target="_blank" rel="noopener" href="https://docs.github.com/zh/actions/managing-workflow-runs-and-deployments/managing-workflow-runs/skipping-workflow-runs">官方文档</a> 。</p><h2 id="后续和优化"><a href="#后续和优化" class="headerlink" title="后续和优化"></a>后续和优化</h2><h3 id="压缩"><a href="#压缩" class="headerlink" title="压缩"></a>压缩</h3><p>使用的是 <a target="_blank" rel="noopener" href="https://github.com/curbengh/hexo-yam">hexo-yam</a></p><p>压缩酌情选择开启，常见的 <code>html</code> <code>css</code> <code>js</code> <code>svg</code> 都是建议压缩的，能减少不少体积。</p><h3 id="sitemap"><a href="#sitemap" class="headerlink" title="sitemap"></a>sitemap</h3><p>使用的是 <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo-generator-sitemap">hexo-generator-sitemap</a></p><h3 id="主题子模块"><a href="#主题子模块" class="headerlink" title="主题子模块"></a>主题子模块</h3><p>如果用的主题是自己维护的，在push了对主题的修改之后，Hexo根目录所在的私有仓库会有个 <code>themes/xxx</code> 的文件夹修改，如果你需要主题的修改生效的话需要提交这个文件夹的修改。<br>其实就是记录的是当前文件夹引用的是哪个版本的子模块，如果不提交就永远使用的旧主题版本。<br>同样如果是别人的开源主题，想要使用新版本，也需要更新子模块，提交这个文件夹的更新。</p><h3 id="CNAME"><a href="#CNAME" class="headerlink" title="CNAME"></a>CNAME</h3><p>由于插件 <code>hexo-deployer-git</code> 每次推送都是清空了分支的，所以配置 <code>CNAME</code> 就不能从仓库那里配置了，在markdown源文件夹根目录下创建即可。</p><blockquote class="copyright"><p>本站所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">BY-NC-SA 4.0</a> 许可协议。转载请注明出处！</p></blockquote></main><nav class="pagination"><span class="prev"></span> <span class="next"><a href="/posts/chengdu-telecom-iptv-udpxy-config">华硕路由器实现iptv组播转单播和单线复用</a></span></nav><script src="/js/main.js"></script><footer><p class="socials"><a href="https://github.com/lostars" target="_blank"><svg class="fontawesome-icon"><use href="/icons/fontawesome.svg#github"></use></svg> </a><a href="https://open.spotify.com/user/boyizmen" target="_blank"><svg class="fontawesome-icon"><use href="/icons/fontawesome.svg#spotify"></use></svg> </a><a href="https://space.bilibili.com/20516992" target="_blank"><svg class="fontawesome-icon"><use href="/icons/fontawesome.svg#bilibili"></use></svg> </a><input type="hidden" id="emailUser" value="bW9tbw=="> <input type="hidden" id="emailDomain" value="bWluZWkubWU="> <a id="emailLink" href="#" target="_blank"><svg class="fontawesome-icon"><use href="/icons/fontawesome.svg#email"></use></svg></a></p><p>Build with ❤ I abandon here my love</p><p>Copyright &copy; 2025 boyizmen</p></footer></body></html>
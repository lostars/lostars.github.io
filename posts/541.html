<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="shortcut icon" href="/images/blog/favicon.svg"><meta name="keywords" content=""><meta name="description" content=""><link rel="stylesheet" href="/styles/main.css"><link rel="stylesheet" href="/styles/post.css"><title>JAVA 14 新特性 - switch表达式 - Daydream</title><meta name="generator" content="Hexo 7.3.0"></head><body><header><nav><ul><li><a href="/">Home</a></li><li><a href="/posts/"><span>Posts</span></a></li><li><a href="/categories/"><span>Categories</span></a></li><li><a href="/about"><span>About</span></a></li></ul></nav></header><main><header><h1>JAVA 14 新特性 - switch表达式</h1><div><time>2020-04-25</time><div class="post-categories"><span class="category-tree"><span class="category-separator">/</span> <a href="/categories/dev/">dev</a></span></div><div class="post-tags"><span class="tag"><span class="category-separator">#</span> <a href="/tags/java/">java</a> </span><span class="tag"><span class="category-separator">#</span> <a href="/tags/jdk14/">jdk14</a></span></div></div></header><p>现在的Java版本号刷的和Chrome一样快，在最新的14版本中加入了switch表达式，和以前使用的switch语句不同，switch表达式带来的不仅仅是编码上的流畅，同时精简了switch语句的使用方式，并且是兼容以前的switch语句。</p><p>以前的switch语句在分支结束的时候往往需要我们手动的进行break，否则switch会一直进行下去直到switch语句结束，这很容易造成一些难以排查的bug。switch语句使用冒号来作为分支代码块的的开始，而switch表达式提供了新的流程切换方式：<code>-&gt;</code> 符号右边的代码执行完成之后会自动结束整个switch语句。<code>-&gt;</code> 右边可以是表达式，代码块或是抛出异常。</p><p>由于变成了表达式，现在switch可以用来进行赋值，比如：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span> <span class="hljs-variable">numLetters</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">switch</span> (day) &#123;<br>    <span class="hljs-keyword">case</span> MONDAY, FRIDAY, SUNDAY -&gt; <span class="hljs-number">6</span>;<br>    <span class="hljs-keyword">case</span> TUESDAY                -&gt; <span class="hljs-number">7</span>;<br>    <span class="hljs-keyword">case</span> THURSDAY, SATURDAY     -&gt; <span class="hljs-number">8</span>;<br>    <span class="hljs-keyword">case</span> WEDNESDAY              -&gt; <span class="hljs-number">9</span>;<br>&#125;;<br></code></pre></td></tr></table></figure><p>虽然switch表达式的出现在一些流程分支上简化了不少编码，但是需要注意以下几点：</p><ol><li>使用时必须要覆盖到所有可能的case分支(包括default)；</li><li>每个分支都必须要yield一个值或者抛出异常；</li><li>switch表达式无法使用break,return,continue来跳出；<br>枚举在使用switch表达式的时候只需要覆盖到所有的枚举值即可，默认的default分支编译期会自动处理加入到表达式中。</li></ol><p>上面的要点提到了 <code>yield</code>，它并不是一个关键字，和 <code>var</code> 一样，都是被严格限制了的类型名。<code>yield</code> 可理解为让，或者是返回。<br>yield语句</p><p>上面的switch表达式是比较简单的yield语句，看下面的代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">switch</span> (day) &#123;<br>    <span class="hljs-keyword">case</span> MONDAY  -&gt; <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">case</span> TUESDAY -&gt; <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">default</span>      -&gt; &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">k</span> <span class="hljs-operator">=</span> day.toString().length();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> f(k);<br>        <span class="hljs-keyword">yield</span> result;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><p>因为switch表达式是兼容以前的switch语句，所以也可以这么写：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">switch</span> (s) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;Foo&quot;</span>: <br>        <span class="hljs-keyword">yield</span> <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;Bar&quot;</span>:<br>        <span class="hljs-keyword">yield</span> <span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">default</span>:<br>        System.out.println(<span class="hljs-string">&quot;Neither Foo nor Bar, hmmm...&quot;</span>);<br>        <span class="hljs-keyword">yield</span> <span class="hljs-number">0</span>;<br>&#125;;<br></code></pre></td></tr></table></figure><p>查看使用switch表达式和switch语句所得到的class文件，发现基本一样，说明switch表达式的实现仍然是Java的语法糖，都是编译器在编译的时候进行处理的。<br>switch表达式的出现可以看到Java在提高使用者编码效率上还是在不停的努力，期待可以看到更多的新特性来提升编码效率和体验。</p><blockquote class="copyright"><p>本站所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">BY-NC-SA 4.0</a> 许可协议。转载请注明出处！</p></blockquote></main><nav class="pagination"><span class="prev"><a href="/posts/26">大理 - 洱海 </a></span><span class="next"><a href="/posts/540">JAVA 10 新特性 - 局部变量推断</a></span></nav><script src="/js/main.js"></script><footer><p class="socials"><a href="https://github.com/lostars" target="_blank"><svg class="fontawesome-icon"><use href="/icons/fontawesome.svg#github"></use></svg> </a><a href="https://open.spotify.com/user/boyizmen" target="_blank"><svg class="fontawesome-icon"><use href="/icons/fontawesome.svg#spotify"></use></svg> </a><a href="https://space.bilibili.com/20516992" target="_blank"><svg class="fontawesome-icon"><use href="/icons/fontawesome.svg#bilibili"></use></svg> </a><input type="hidden" id="emailUser" value="bW9tbw=="> <input type="hidden" id="emailDomain" value="bWluZWkubWU="> <a id="emailLink" href="#" target="_blank"><svg class="fontawesome-icon"><use href="/icons/fontawesome.svg#email"></use></svg></a></p><p>Build with ❤ I abandon here my love</p><p>Copyright &copy; 2025 boyizmen</p></footer></body></html>